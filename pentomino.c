char pen[12][8][8][5]={


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,1,1,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen2=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		1,1,0,0,0,
		0,0,0,0,0,


		0,1,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,1,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,1,0,
		0,0,0,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,1,0,
/**/	1,1,1,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,1,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen3=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		0,0,1,0,0,
		0,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,0,0,0,0,
		1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,1,0,0,
		0,0,1,0,0,
/**/	1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen4=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		0,0,1,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,1,1,0,
/**/	1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,1,1,0,
/**/	1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		0,1,1,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,0,0,0,0,
		1,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen5=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,1,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,1,0,0,
/**/	1,1,1,0,0,
		0,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
/**/	1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen6=


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,1,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen7=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		0,1,1,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,1,0,0,0,
		0,1,1,0,0,
/**/	1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		0,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,1,0,0,
/**/	1,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,1,0,0,
		0,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,1,0,0,
/**/	1,1,1,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,1,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,1,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen8=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,0,0,0,
		1,0,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,0,0,0,0,
		1,1,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		0,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,1,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,1,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,1,0,
		0,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,1,0,0,
/**/	1,1,1,1,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen9=


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		0,1,1,0,0,
		0,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,1,0,0,
		0,1,1,0,0,
/**/	1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,0,0,0,
		0,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,1,0,0,
/**/	1,1,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen10{


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,0,0,0,
		1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		1,1,0,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		1,1,0,0,0,
		0,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		0,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,1,1,0,0,
/**/	1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen11{


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,1,0,0,
		1,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,1,0,0,
		1,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		1,0,0,0,0,
		1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		0,1,0,0,0,
		1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,



//const PEN pen12{


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,1,0,0,0,
		0,1,0,0,0,
		0,1,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,1,1,0,0,
		0,1,0,0,0,
/**/	1,1,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,1,0,0,
/**/	1,1,1,0,0,
		1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
/**/	1,0,0,0,0,
		1,1,1,0,0,
		0,0,1,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


		-1,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,
		0,0,0,0,0,


};



#include "os_call.c"
#include "disp.c"
#include "string.c"


#define macrox(pos) ((pos)%12)			// 10x6 の盤、縁を付けて 12x8
#define macroy(pos) ((pos)/12)
#define macropos(x,y) ((x)+(y)*12)

//struct pen_move{
//	int pos;							// 置く pos
//	int i;
//	int k;
//};
//
//struct pen_move pen_move[12];

int pen_color[12]={
	0xc618,0x53d7,0xcd7f,0x0e5f,0xb73d,0x1f36,0xeed3,0xbc8e,0xa254,0xca47,0xed00,0x4d84,
};

int pen_pos[12];
int pen_i[12];
int pen_k[12];
int peni[12][8][5];						// pos 定義, stopper = 10000
char pen_ban[8][12];					// 盤


//extern const char pen[12][8][8][5];

/********************************************************************************/
/*		pen_disp_1																*/
/*		20x20 の正方形を表示する												*/
/*		x=1〜10, y=1〜6															*/
/********************************************************************************/
void pen_disp_1(int pos, int color)
{
	int x, y, xx, yy;
	
	x = macrox(pos);
	y = macroy(pos);
	if(x<1 || x>10 || y<1 || y>6){
		printf("*** pen_disp_1 err1 x=%d y=%d\n", x, y);
		for(;;)
			;
	}
//	lcd_clearA((x-1)*20+60, (y-1)*20+60, (x-1)*20+60+20-1, (y-1)*20+60+20-1, color);
	for(yy=(y-1)*20+60; yy<(y-1)*20+60+20; yy++){
		for(xx=(x-1)*20+60; xx<(x-1)*20+60+20; xx++){
			Pset(xx, yy, 0);
		}
	}
}

void pen_waku()
{
//	lcd_clearA(60-1, 60-1, 200+60, 60-1, BLACK);
//	lcd_clearA(60-1, 120+60, 200+60, 120+60, BLACK);
//	lcd_clearA(60-1, 60-1, 60-1, 120+60, BLACK);
//	lcd_clearA(200+60, 60-1, 200+60, 120+60, BLACK);

	int x, y;
	
	y = 60-1;
	for(x=60-1; x<=200+60; x++)
		Pset(x, y, 1);
	y = 120+60;
	for(x=60-1; x<=200+60; x++)
		Pset(x, y, 1);
	x = 60-1;
	for(y=60-1; y<=120+60; y++)
		Pset(x, y, 1);
	x = 200+60;
	for(y=60-1; y<=120+60; y++)
		Pset(x, y, 1);
}
/********************************************************************************/
/*		pen_test_move															*/
/*		return 1:置ける、0:置けない											*/
/********************************************************************************/
int pen_test_move(int n /*struct pen_move *move*/)
{
	int cnt, p;
    char *ban;
    
	ban = (char*)pen_ban;
	for(cnt=0; cnt<5; cnt++){
		p = peni[pen_i[n]][pen_k[n]][cnt];
		if(ban[pen_pos[n] + p])		// 置けない
			return 0;
	}
	return 1;							// 置ける
}
/********************************************************************************/
/*		pen_put_to_disp															*/
/********************************************************************************/
void pen_put_to_disp(int n /*struct pen_move *move*/)
{
	int i, cnt, p, pp, x, y, xx, yy, U, D, R, L;
	
	/*** 四角表示	***/
	for(cnt=0; cnt<5; cnt++){
		pen_disp_1(pen_pos[n] + peni[pen_i[n]][pen_k[n]][cnt], /*pen_color[pen_i[n]]*/ pen_i[n]);
	}
	
	/*** 枠表示	***/
	for(cnt=0; cnt<5; cnt++){
		p = peni[pen_i[n]][pen_k[n]][cnt];
		U = D = R = L = 1;
		for(i=0; i<5; i++){
			pp = peni[pen_i[n]][pen_k[n]][i];
			if(p-12 == pp)				// 上不要
				U = 0;
			if(p+12 == pp)				// 下不要
				D = 0;
			if(p-1 == pp)				// 左不要
				L = 0;
			if(p+1 == pp)				// 右不要
				R = 0;
		}
		x = macrox(pen_pos[n] + p);
		y = macroy(pen_pos[n] + p);
		if(U){
//			lcd_clearA((x-1)*20+60, (y-1)*20+60, (x-1)*20+60+20-1, (y-1)*20+60, BLACK);
			yy = (y-1)*20+60;
			for(xx=(x-1)*20+60; xx<(x-1)*20+60+20; xx++)
				Pset(xx, yy, 1);
		}
		if(D){
//			lcd_clearA((x-1)*20+60, (y-1)*20+60+20-1, (x-1)*20+60+20-1, (y-1)*20+60+20-1, BLACK);
			yy = (y-1)*20+60+20-1;
			for(xx=(x-1)*20+60; xx<(x-1)*20+60+20; xx++)
				Pset(xx, yy, 1);
		}
		if(L){
//			lcd_clearA((x-1)*20+60, (y-1)*20+60, (x-1)*20+60, (y-1)*20+60+20-1, BLACK);
			xx = (x-1)*20+60;
			for(yy=(y-1)*20+60; yy<(y-1)*20+60+20; yy++)
				Pset(xx, yy, 1);
		}
		if(R){
//			lcd_clearA((x-1)*20+60+20-1, (y-1)*20+60, (x-1)*20+60+20-1, (y-1)*20+60+20-1, BLACK);
			xx = (x-1)*20+60+20-1;
			for(yy=(y-1)*20+60; yy<(y-1)*20+60+20; yy++)
				Pset(xx, yy, 1);
		}
	}
}
/********************************************************************************/
/*		pen_remove_from_disp													*/
/********************************************************************************/
void pen_remove_from_disp(int n /*struct pen_move *move*/)
{
	int cnt;
	
	/*** 四角表示	***/
	for(cnt=0; cnt<5; cnt++){
		pen_disp_1(pen_pos[n] + peni[pen_i[n]][pen_k[n]][cnt], /*WHITE*/ ' '-'0');
	}
}
/********************************************************************************/
/*		make_peni																*/
/********************************************************************************/
void make_peni()
{
	int i, k, x, y, cnt, top_pos;
	
	for(i=0; i<12; i++){				// 12個の駒について
		for(k=0; k<8; k++){				// 8回転について
			if(pen[i][k][0][0] < 0){
				peni[i][k][0] = 10000;	// stopper
				break;
			}
			top_pos = -1;
			cnt = 0;
			for(x=0; x<5; x++){
				for(y=0; y<8; y++){
					if(pen[i][k][y][x]){
						if(top_pos < 0){
							if(x != 0 || y != 3){	// top pos check
								printf("*** make_peni err1, i=%d k=%d y=%d x=%d\n", i, k, y, x);
								for(;;)
									;
							}
							top_pos = macropos(x,y);
						}
						peni[i][k][cnt] = macropos(x,y) - top_pos;
						++cnt;
					}
				}
			}
			if(cnt != 5){				// 四角の数が５個であること
				printf("*** make_peni err2, i=%d k=%d cnt=%d\n", i, k, cnt);
				for(;;)
					;
			}
		}
	}
}
/********************************************************************************/
/*		pen_ban_init															*/
/********************************************************************************/
void pen_ban_init()
{
	int x, y;
	
	memset(pen_ban, 0, sizeof(pen_ban));
	for(y=0; y<8; y++){
		pen_ban[y][0] = 1;
		pen_ban[y][12-1] = 1;
	}
	for(x=0; x<12; x++){
		pen_ban[0][x] = 1;
		pen_ban[8-1][x] = 1;
	}
}
/********************************************************************************/
/*		pen_put_to_ban															*/
/********************************************************************************/
void pen_put_to_ban(int n /*struct pen_move *move*/)
{
	int cnt, p;
	char *ban;
	
	ban = (char*)pen_ban;
	if(peni[pen_i[n]][pen_k[n]][0]==10000){
		printf("put_to_ban err1 i=%d k=%d\n", pen_i[n], pen_k[n]);
		for(;;)
			;
	}
	for(cnt=0; cnt<5; cnt++){
		p = peni[pen_i[n]][pen_k[n]][cnt];
		ban[pen_pos[n] + p] = 1;
	}
}
/********************************************************************************/
/*		pen_remove_from_ban														*/
/********************************************************************************/
void pen_remove_from_ban(int n /*struct pen_move *move*/)
{
	int cnt, p;
	char *ban;
	
	ban = (char*)pen_ban;
	if(peni[pen_i[n]][pen_k[n]][0]==10000){
		printf("*** remove_from_ban err1 i=%d k=%d\n", pen_i[n], pen_k[n]);
		for(;;)
			;
	}
	for(cnt=0; cnt<5; cnt++){
		p = peni[pen_i[n]][pen_k[n]][cnt];
		ban[pen_pos[n] + p] = 0;
	}
}
/********************************************************************************/
/*		pen_top_pos																*/
/*		盤の空き位置のうち、左の上を返す										*/
/********************************************************************************/
int pen_top_pos()
{
	int x, y, p;
	char *ban;
	
	ban = (char*)pen_ban;
	for(x=1; x<=10; x++){
		for(y=1; y<=6; y++){
			p = macropos(x,y);
			if(ban[p]==0)
				return p;
		}
	}
	printf("*** pen_top_pos err1\n");
	for(;;)
		;
    return 0;
}
/********************************************************************************/
/*      pen_test                                                                */
/********************************************************************************/
void pen_test()
{
    int x, y;
	char *ban;
	
	ban = (char*)pen_ban;
    for(x=0; x<12; x++){
        if(ban[macropos(x,0)]==0)
            goto err1;
        if(ban[macropos(x,8-1)]==0)
            goto err1;
    }
    for(y=0; y<8; y++){
        if(ban[macropos(0,y)]==0)
            goto err1;
        if(ban[macropos(12-1,y)]==0)
            goto err1;
    }
    return;
    
err1:; printf("*** pen_test error\n");
	for(;;)
		;
}
/********************************************************************************/
/*		pen_disp_all															*/
/********************************************************************************/
void pen_disp_all()
{
	int i;
	
	for(i=0; i<12; i++){
		pen_put_to_disp(i);
	}
}
/********************************************************************************/
/*		pentomino																*/
/********************************************************************************/
void pentomino(int fast)
{
	int sw, ii, m, up, use[12], count;
	
    make_peni();
    pen_ban_init();
    scrn_clear();
    pen_waku();
	memset(use, 0, sizeof(use));
    count = 0;
	ii = 0;
	up = 1;
	for(;;){
		if(fast==0){
//			sw = sw_read();
//			if(sw){
//				return;
//			}
		}
//		pen_test();//AAAAA 盤の縁をテスト
		if(up==1){							// 前進した
			for(m=0; m<12; m++){
				if(use[m]==0){
					use[m] = 1;
					break;
				}
			}
			if(m==12){
				printf("*** pentomino err1 ii=%d\n", ii);
				for(;;)
					;
			}
			pen_i[ii] = m;
			pen_k[ii] = 0;
			pen_pos[ii] = pen_top_pos();
		}
		else{								// 続きを実行 (後退した)
            if(up==0){
    			pen_remove_from_ban(ii);
    			if(fast==0)
					pen_remove_from_disp(ii);
            }
			++pen_k[ii];
			if(pen_k[ii] >= 8 || peni[pen_i[ii]][pen_k[ii]][0] == 10000){	// 回転方向全部試した
				for(m=pen_i[ii]+1; m<12; m++){
					if(use[m]==0){
						use[m] = 1;
						break;
					}
				}
				use[pen_i[ii]] = 0;
				if(m==12){						// 全部テストしたから後退する
					up = 0;
					ii--;
					if(ii<0){					// 終了
						printf("pentomino end\n");
						ut_getc();
						return;
					}
					continue;
				}
				pen_i[ii] = m;
				pen_k[ii] = 0;
			}
		}
		if(pen_test_move(ii)){	// 置けるならば
			pen_put_to_ban(ii);	// 盤に置く
			if(fast==0){
				pen_put_to_disp(ii);	// 表示する
				wait_ms(100);
			}
			if(ii== 12-1){					// 完成した
				if(fast==0){
					scrn_clear();
					pen_waku();
					pen_disp_all();
					wait_ms(10000);
					
					scrn_clear();
					pen_waku();
					pen_disp_all();
				}
				else{
					cursor_set(0,0);
//                    lcd_x = lcd_y = 0;
                    printf("count=%d\n", ++count);
					pen_disp_all();
//					sw = sw_read();
//					if(sw){
//						return;
//					}
				}
				up = 0;
			}
			else{							// 未完成, 前進する
				up = 1;
				ii++;
			}
		}
		else{								// 置けない
			up = 2;							// 続きを実行
		}
	}
}
/********************************************************************************/
/*		main																	*/
/********************************************************************************/
int main()
{
	for(;;){
		printf("\nfinish display   (y/n) ? ");
		if(ut_getc()=='y')
			pentomino(1);
		printf("\nprogress display (y/n) ? ");
		if(ut_getc()=='y')
			pentomino(0);
	}
}





//
//==============================================================================
//
//const PEN pen1={

